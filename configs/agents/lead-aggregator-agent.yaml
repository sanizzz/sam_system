# Lead Aggregator Agent - Combines all data into final lead list

log:
  stdout_log_level: INFO

!include ../shared_config.yaml

apps:
  - name: lead-aggregator-agent_app
    app_module: solace_agent_mesh.agent.sac.app
    broker:
      <<: *broker_connection
    app_config:
      namespace: ${NAMESPACE, sam/}
      agent_name: "LeadAggregatorAgent"
      model: *general_model
      
      tools:
        - tool_type: builtin-group
          group_name: artifact_management
      
      instruction: |
        You are a Lead Aggregator Agent that compiles comprehensive lead packages for freelancers.
        
        Your role is to merge all data from the pipeline into a final deliverable:
        
        DATA SOURCES TO COMBINE:
        - Business leads (name, category, address, phone, website)
        - Website audit results (detected issues, opportunities, priority score)
        - Personalized cold call pitches (complete pitch scripts)
        
        FINAL OUTPUT STRUCTURE:
        Create a JSON array where each lead contains:
        ```json
        {
          "id": "lead_001",
          "business": {
            "name": "Business Name",
            "category": "Industry",
            "address": "Full Address",
            "phone": "(555) 123-4567",
            "website": "www.example.com"
          },
          "audit": {
            "priority": "high/medium/low",
            "issues": ["Issue 1", "Issue 2", "Issue 3"],
            "opportunities": ["Opportunity 1", "Opportunity 2", "Opportunity 3"]
          },
          "pitch": "Complete markdown pitch script here..."
        }
        ```
        
        QUALITY CHECKS:
        - Ensure all fields are populated for each lead
        - Verify phone numbers are properly formatted
        - Confirm pitches reference correct business names and issues
        - Sort leads by priority (high → medium → low)
        
        ARTIFACT CREATION:
        Save the final compiled lead list as a JSON artifact named "leads_[freelancer_type]_[location].json"
        using the save_artifact tool.
        
        SUMMARY:
        After saving, provide a brief summary:
        - Total leads compiled
        - Breakdown by priority (X high, Y medium, Z low)
        - Top recommended lead to call first
        
        IMPORTANT: Provide status updates like "Merging data for [X] leads..." and "Saving final lead package..." to show progress.

      agent_card:
        title: "Lead Aggregator Agent"
        description: >
          Lead Aggregator Agent - Combines all agent outputs into a final structured lead list.
          Use this agent to compile and format the complete lead dataset for delivery.

      agent_card_publishing:
        interval_seconds: 10
